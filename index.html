import React, { useState, useEffect } from 'react';
import { Menu, X, ArrowRight, ChevronLeft, Share2, Clock, Calendar, User } from 'lucide-react';

// --- MOCK DATA ---

const CATEGORIES = [
  {
    id: 'design',
    title: 'Design',
    description: 'Exploring minimalism, UI/UX, and visual storytelling.',
    image: 'https://images.unsplash.com/photo-1561070791-2526d30994b5?auto=format&fit=crop&q=80&w=1000',
  },
  {
    id: 'tech',
    title: 'Technology',
    description: 'The future of code, AI, and digital infrastructure.',
    image: 'https://images.unsplash.com/photo-1518770660439-4636190af475?auto=format&fit=crop&q=80&w=1000',
  },
  {
    id: 'culture',
    title: 'Culture',
    description: 'Reflections on modern society and art.',
    image: 'https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&q=80&w=1000',
  },
  {
    id: 'lifestyle',
    title: 'Lifestyle',
    description: 'Slow living, travel, and personal growth.',
    image: 'https://images.unsplash.com/photo-1476514525535-07fb3b4ae5f1?auto=format&fit=crop&q=80&w=1000',
  }
];

// Generating 4 posts per category
const POSTS = CATEGORIES.flatMap(cat => 
  Array.from({ length: 4 }).map((_, i) => ({
    id: `${cat.id}-${i}`,
    categoryId: cat.id,
    title: `${cat.title} Article ${i + 1}: The Modern Era`,
    excerpt: `A brief exploration into the depths of ${cat.title.toLowerCase()} and how it shapes our daily perception of reality in the digital age.`,
    content: `
      <p class="mb-6">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</p>
      <h3 class="text-2xl font-bold mb-4 text-white">The Shift in Perspective</h3>
      <p class="mb-6">Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
      <p class="mb-6">Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam, eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt explicabo.</p>
      <blockquote class="border-l-4 border-[#0A1F44] pl-4 italic text-gray-400 mb-6">
        "Design is not just what it looks like and feels like. Design is how it works."
      </blockquote>
      <p>Nemo enim ipsam voluptatem quia voluptas sit aspernatur aut odit aut fugit, sed quia consequuntur magni dolores eos qui ratione voluptatem sequi nesciunt.</p>
    `,
    image: `https://images.unsplash.com/photo-${1500000000000 + (i * 10000) + (cat.id.length * 500)}?auto=format&fit=crop&q=80&w=1000`,
    date: 'Oct 24, 2023',
    readTime: '5 min read',
    author: 'Alex Noir'
  }))
);

// --- COMPONENTS ---

const Header = ({ onNavigate, currentView, toggleMenu, isMenuOpen }) => (
  <header className="fixed top-0 left-0 right-0 z-50 bg-black/80 backdrop-blur-md border-b border-white/10 transition-all duration-300">
    <div className="max-w-7xl mx-auto px-6 h-20 flex items-center justify-between">
      <div 
        onClick={() => onNavigate('home')} 
        className="text-2xl font-bold tracking-tighter cursor-pointer text-white hover:opacity-80 transition-opacity"
      >
        NOIR.
      </div>
      
      <button 
        onClick={toggleMenu}
        className="text-white hover:text-gray-300 transition-colors p-2"
      >
        {isMenuOpen ? <X size={28} /> : <Menu size={28} />}
      </button>
    </div>

    {/* Mobile/Overlay Menu */}
    <div className={`fixed inset-0 bg-black z-40 flex flex-col items-center justify-center space-y-8 transition-transform duration-500 ease-in-out ${isMenuOpen ? 'translate-y-0' : '-translate-y-full'}`}>
      <nav className="flex flex-col items-center space-y-6">
        {['Home', 'Categories', 'About', 'Contact'].map((item) => (
          <button
            key={item}
            onClick={() => {
              toggleMenu();
              if (item === 'Home') onNavigate('home');
              if (item === 'Categories') onNavigate('categories');
            }}
            className="text-4xl font-bold text-white hover:text-[#0A1F44] transition-colors tracking-tight"
          >
            {item}
          </button>
        ))}
      </nav>
    </div>
  </header>
);

const Hero = ({ onReadClick }) => (
  <div className="relative min-h-screen flex flex-col pt-20">
    {/* Hero Section */}
    <div className="flex-1 flex flex-col justify-center px-6 max-w-7xl mx-auto w-full relative z-10">
      <div className="w-full max-w-4xl">
        <h1 className="text-6xl md:text-8xl font-bold text-white tracking-tighter mb-6 leading-tight animate-fade-in-up">
          CLARITY IN <br />
          <span className="text-transparent bg-clip-text bg-gradient-to-r from-white to-gray-500">DARKNESS.</span>
        </h1>
        <p className="text-gray-400 text-lg md:text-xl max-w-xl mb-12 leading-relaxed font-light">
          A digital sanctuary for thoughts on design, technology, and modern living. 
          Minimalism isn't just an aesthetic; it's a mindset.
        </p>
      </div>
    </div>

    {/* Image Grid */}
    <div className="w-full max-w-7xl mx-auto px-6 pb-20 grid grid-cols-1 md:grid-cols-3 gap-4 h-96 md:h-80">
      {[0, 1, 2].map((i) => (
        <div key={i} className="relative group overflow-hidden rounded-lg h-full">
          <img 
            src={`https://images.unsplash.com/photo-${1515000000000 + i * 99999}?auto=format&fit=crop&q=80&w=800`} 
            alt="Mood" 
            className="object-cover w-full h-full transition-transform duration-700 group-hover:scale-110 grayscale group-hover:grayscale-0"
          />
          <div className="absolute inset-0 bg-black/20 group-hover:bg-transparent transition-colors duration-300" />
        </div>
      ))}
    </div>

    {/* CTA Section */}
    <div className="pb-24 flex justify-center">
      <button 
        onClick={onReadClick}
        className="group relative px-12 py-4 bg-[#0A1F44] text-white rounded-full font-bold tracking-widest overflow-hidden hover:shadow-[0_0_20px_rgba(10,31,68,0.6)] transition-all duration-300"
      >
        <span className="relative z-10 flex items-center gap-2">
          READ
          <ArrowRight size={18} className="group-hover:translate-x-1 transition-transform" />
        </span>
        <div className="absolute inset-0 bg-blue-900 opacity-0 group-hover:opacity-100 transition-opacity duration-300" />
      </button>
    </div>
  </div>
);

const CategoriesView = ({ onCategorySelect }) => (
  <div className="min-h-screen pt-32 px-6 pb-20 max-w-7xl mx-auto">
    <div className="text-center mb-16">
      <h2 className="text-4xl md:text-5xl font-bold text-white mb-4 tracking-tight">Browse Topics</h2>
      <div className="w-16 h-1 bg-[#0A1F44] mx-auto rounded-full"></div>
    </div>

    <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
      {CATEGORIES.map((cat) => (
        <div 
          key={cat.id}
          className="group relative bg-[#0a0a0a] border border-white/5 rounded-2xl p-8 overflow-hidden hover:border-[#0A1F44]/50 transition-all duration-500"
        >
          {/* Hover Background Image Effect */}
          <div className="absolute inset-0 opacity-0 group-hover:opacity-20 transition-opacity duration-700">
             <img src={cat.image} className="w-full h-full object-cover grayscale" alt="" />
          </div>

          <div className="relative z-10 flex flex-col h-full justify-between items-start min-h-[200px]">
            <div>
              <h3 className="text-3xl font-bold text-white mb-2">{cat.title}</h3>
              <p className="text-gray-400">{cat.description}</p>
            </div>
            
            <button
              onClick={() => onCategorySelect(cat)}
              className="mt-8 px-6 py-2 bg-white text-black font-bold rounded-lg hover:bg-[#0A1F44] hover:text-white transition-all duration-300 ease-out flex items-center gap-2"
            >
              Explore
              <ArrowRight size={16} />
            </button>
          </div>
        </div>
      ))}
    </div>
  </div>
);

const BlogListView = ({ category, onPostSelect, onBack }) => {
  const posts = POSTS.filter(p => p.categoryId === category.id);

  return (
    <div className="min-h-screen pt-28 px-6 pb-20 max-w-7xl mx-auto">
      <div className="flex items-center gap-4 mb-12">
        <button 
          onClick={onBack}
          className="p-2 rounded-full border border-white/10 hover:bg-white hover:text-black transition-all text-white"
        >
          <ChevronLeft size={24} />
        </button>
        <div>
          <span className="text-[#0A1F44] font-bold tracking-widest text-sm uppercase">Category</span>
          <h2 className="text-4xl font-bold text-white">{category.title}</h2>
        </div>
      </div>

      <div className="space-y-8">
        {posts.map((post) => (
          <div 
            key={post.id}
            onClick={() => onPostSelect(post)}
            className="group flex flex-col md:flex-row gap-6 bg-[#050505] p-6 rounded-2xl border border-white/5 hover:border-[#0A1F44] transition-all duration-300 cursor-pointer"
          >
            <div className="w-full md:w-1/3 h-48 md:h-auto overflow-hidden rounded-xl">
              <img 
                src={post.image} 
                alt={post.title}
                className="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105"
              />
            </div>
            <div className="flex-1 flex flex-col justify-center">
              <div className="flex items-center gap-4 text-xs text-gray-500 mb-2">
                <span className="flex items-center gap-1"><Calendar size={12} /> {post.date}</span>
                <span className="flex items-center gap-1"><Clock size={12} /> {post.readTime}</span>
              </div>
              <h3 className="text-2xl font-bold text-white mb-3 group-hover:text-[#4d7acc] transition-colors">{post.title}</h3>
              <p className="text-gray-400 mb-6 line-clamp-2">{post.excerpt}</p>
              
              <span className="inline-flex items-center gap-2 text-sm font-bold text-white border-b border-transparent group-hover:border-[#0A1F44] w-fit pb-1 transition-all">
                Read Article <ArrowRight size={14} />
              </span>
            </div>
          </div>
        ))}
      </div>
    </div>
  );
};

const BlogPostView = ({ post, onBack, categoryTitle }) => (
  <div className="min-h-screen pt-28 pb-20 bg-black">
    {/* Progress Bar (Simulated) */}
    <div className="fixed top-20 left-0 h-1 bg-[#0A1F44] w-full origin-left animate-grow-x z-40" />

    <div className="max-w-4xl mx-auto px-6">
      {/* Nav */}
      <div className="flex justify-between items-center mb-8">
        <button 
          onClick={onBack}
          className="flex items-center gap-2 text-gray-400 hover:text-white transition-colors"
        >
          <ChevronLeft size={20} /> Back to {categoryTitle}
        </button>
        <div className="flex gap-4">
          <button className="text-gray-400 hover:text-[#0A1F44] transition-colors">
            <Share2 size={20} />
          </button>
        </div>
      </div>

      {/* Header */}
      <div className="mb-10 text-center">
        <span className="bg-[#0A1F44]/20 text-blue-200 px-3 py-1 rounded-full text-xs font-bold uppercase tracking-widest mb-4 inline-block">
          {categoryTitle}
        </span>
        <h1 className="text-3xl md:text-5xl font-bold text-white leading-tight mb-6">
          {post.title}
        </h1>
        <div className="flex justify-center items-center gap-6 text-sm text-gray-500">
           <span className="flex items-center gap-2"><User size={14} /> {post.author}</span>
           <span className="flex items-center gap-2"><Calendar size={14} /> {post.date}</span>
           <span className="flex items-center gap-2"><Clock size={14} /> {post.readTime}</span>
        </div>
      </div>

      {/* Featured Image */}
      <div className="w-full h-[400px] md:h-[500px] rounded-2xl overflow-hidden mb-12 shadow-2xl shadow-blue-900/10">
        <img src={post.image} alt={post.title} className="w-full h-full object-cover" />
      </div>

      {/* Content */}
      <article 
        className="prose prose-invert prose-lg max-w-none text-gray-300 leading-relaxed"
        dangerouslySetInnerHTML={{ __html: post.content }}
      />

      {/* Footer of Article */}
      <div className="mt-16 pt-8 border-t border-white/10 flex justify-between items-center">
        <h4 className="text-white font-bold">Share this article</h4>
        <div className="flex gap-4">
          {['Twitter', 'Facebook', 'LinkedIn'].map(social => (
            <button key={social} className="text-xs font-bold text-gray-500 hover:text-white uppercase transition-colors">
              {social}
            </button>
          ))}
        </div>
      </div>
    </div>
  </div>
);

const Footer = () => (
  <footer className="bg-black border-t border-white/5 py-12 px-6">
    <div className="max-w-7xl mx-auto flex flex-col md:flex-row justify-between items-center gap-6">
      <div className="text-xl font-bold text-white tracking-tighter">NOIR.</div>
      <div className="text-gray-600 text-sm">Â© 2024 Noir Blog. All rights reserved.</div>
      <div className="flex gap-6">
        <a href="#" className="text-gray-500 hover:text-white transition-colors">Instagram</a>
        <a href="#" className="text-gray-500 hover:text-white transition-colors">Twitter</a>
        <a href="#" className="text-gray-500 hover:text-white transition-colors">RSS</a>
      </div>
    </div>
  </footer>
);

// --- MAIN APP COMPONENT ---

export default function App() {
  const [view, setView] = useState('home'); // home, categories, list, article
  const [activeCategory, setActiveCategory] = useState(null);
  const [activePost, setActivePost] = useState(null);
  const [isMenuOpen, setIsMenuOpen] = useState(false);

  // Scroll to top on view change
  useEffect(() => {
    window.scrollTo(0, 0);
  }, [view, activeCategory, activePost]);

  const handleNavigate = (targetView) => {
    setView(targetView);
    setIsMenuOpen(false); // Close menu if navigating
  };

  const handleCategorySelect = (category) => {
    setActiveCategory(category);
    handleNavigate('list');
  };

  const handlePostSelect = (post) => {
    setActivePost(post);
    handleNavigate('article');
  };

  return (
    <div className="min-h-screen bg-black text-white font-sans selection:bg-[#0A1F44] selection:text-white overflow-x-hidden">
      <Header 
        onNavigate={handleNavigate} 
        currentView={view} 
        toggleMenu={() => setIsMenuOpen(!isMenuOpen)}
        isMenuOpen={isMenuOpen}
      />

      <main className="animate-fade-in">
        {view === 'home' && (
          <Hero onReadClick={() => handleNavigate('categories')} />
        )}

        {view === 'categories' && (
          <CategoriesView onCategorySelect={handleCategorySelect} />
        )}

        {view === 'list' && activeCategory && (
          <BlogListView 
            category={activeCategory} 
            onPostSelect={handlePostSelect}
            onBack={() => handleNavigate('categories')}
          />
        )}

        {view === 'article' && activePost && (
          <BlogPostView 
            post={activePost} 
            categoryTitle={CATEGORIES.find(c => c.id === activePost.categoryId)?.title}
            onBack={() => handleNavigate('list')}
          />
        )}
      </main>

      <Footer />
      
      {/* Global Animation Styles */}
      <style>{`
        @keyframes grow-x {
          from { transform: scaleX(0); }
          to { transform: scaleX(1); }
        }
        .animate-grow-x {
          animation: grow-x 1s ease-out forwards;
        }
        @keyframes fade-in-up {
          from { opacity: 0; transform: translateY(20px); }
          to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in-up {
          animation: fade-in-up 0.8s ease-out forwards;
        }
      `}</style>
    </div>
  );
}
